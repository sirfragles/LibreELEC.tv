From 354ddfecd33067d8aac339437defdcf0b8c32b68 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Tommi=20M=C3=A4kitalo?= <tommi@tntnet.org>
Date: Tue, 25 Apr 2023 13:44:17 +0200
Subject: [PATCH] Fix for C++20

some typedefs are removed from std::allocator
---
 include/cxxtools/string.h | 8 ++++----
 src/charmapcodec.cpp      | 2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/include/cxxtools/string.h b/include/cxxtools/string.h
index e8ea4f25..020bb043 100644
--- a/include/cxxtools/string.h
+++ b/include/cxxtools/string.h
@@ -51,10 +51,10 @@ class basic_string< cxxtools::Char > {
         typedef char_traits< cxxtools::Char > traits_type;
         typedef std::allocator<cxxtools::Char> allocator_type;
         typedef allocator_type::difference_type difference_type;
-        typedef allocator_type::reference reference;
-        typedef allocator_type::const_reference const_reference;
-        typedef allocator_type::pointer pointer;
-        typedef allocator_type::const_pointer const_pointer;
+        typedef value_type& reference;
+        typedef const value_type& const_reference;
+        typedef value_type* pointer;
+        typedef const value_type* const_pointer;
         typedef value_type* iterator;
         typedef const value_type* const_iterator;
 
diff --git a/src/charmapcodec.cpp b/src/charmapcodec.cpp
index 5eb08136..2e01b2a9 100644
--- a/src/charmapcodec.cpp
+++ b/src/charmapcodec.cpp
@@ -82,7 +82,7 @@ CharMapCodec::result CharMapCodec::do_out(MBState& /*s*/, const Char* fromBegin,
     while (fromNext < fromEnd && toNext < toEnd)
     {
         *toNext = toChar(_charMap, *fromNext);
-        log_debug(fromNext->value() << " => " << static_cast<unsigned>(static_cast<unsigned char>(*toNext)));
+        log_debug(static_cast<unsigned>(fromNext->value()) << " => " << static_cast<unsigned>(static_cast<unsigned char>(*toNext)));
         ++fromNext;
         ++toNext;
     }
